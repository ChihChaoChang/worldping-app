{"version":3,"sources":["../../../src/components/endpoint/endpoint_config.js"],"names":[],"mappings":"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","file":"endpoint_config.js","sourcesContent":["import _ from 'lodash';\n\nclass EndpointConfigCtrl {\n   /** @ngInject */\n  constructor($scope, $injector, $location, $modal, $anchorScroll, $timeout, $window, backendSrv, alertSrv) {\n    var self = this;\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n    this.alertSrv = alertSrv;\n    this.pageReady = false;\n    this.monitorLastState = {};\n\n    this.frequencyOpts = [];\n    var freqOpt = [10, 30, 60, 120];\n    _.forEach(freqOpt, function(f) {\n      self.frequencyOpts.push({value: f, label: \"Every \"+f+\"s\"});\n    });\n\n    this.timeoutRegex = /^([1-9](\\.\\d)?|10)$/;\n    this.editor = {index: 0};\n    this.newEndpointName = \"\";\n    this.allCollectors = [];\n    this.collectorsOption = {selection: \"all\"};\n    this.collectorsByTag = {};\n    this.global_collectors = {collector_ids: [], collector_tags: []};\n    this.ignoreChanges = false;\n    this.originalState = {};\n    this.discovered = false;\n    this.discoveryInProgress = false;\n    this.discoveryError = false;\n    this.showConfig = false;\n    \n    this.defaultChecks = {\n      http: {\n        type: \"http\",\n        settings: {\n          \"timeout\": 5,\n          \"hostname\": \"\",\n          \"port\": 80,\n          \"path\": \"/\",\n          \"method\": \"GET\",\n          \"headers\": \"User-Agent: worldping-probe\\nAccept-Encoding: gzip\\n\",\n          \"expectRegex\": \"\"\n        },\n        enabled: false,\n        frequency: 60,\n        healthSettings: {\n          steps: 3,\n          numCollectors: 1,\n          notifications: {\n            enabled: false,\n            addresses: \"\"\n          }\n        }\n      },\n      https: {\n        type: \"https\",\n        settings: {\n          \"timeout\": 5,\n          \"hostname\": \"\",\n          \"port\": 443,\n          \"path\": \"/\",\n          \"method\": \"GET\",\n          \"headers\": \"User-Agent: worldping-probe\\nAccept-Encoding: gzip\\n\",\n          \"expectRegex\": \"\",\n          \"validateCert\": true\n        },\n        enabled: false,\n        frequency: 60,\n        healthSettings: {\n          steps: 3,\n          numCollectors: 1,\n          notifications: {\n            enabled: false,\n            addresses: \"\"\n          }\n        }\n      },\n      dns: {\n        type: \"dns\",\n        settings: {\n          \"timeout\": 5,\n          \"hostname\": \"\",\n          \"type\": \"A\",\n          \"server\": \"8.8.8.8\",\n          \"port\": 53,\n          \"protocol\": \"udp\"\n        },\n        enabled: false,\n        frequency: 60,\n        healthSettings: {\n          steps: 3,\n          numCollectors: 1,\n          notifications: {\n            enabled: false,\n            addresses: \"\"\n          }\n        }\n      },\n      ping: {\n        type: \"ping\",\n        settings: {\n          \"hostname\": \"\",\n          \"timeout\": 5\n        },\n        enabled: false,\n        frequency: 10,\n        healthSettings: {\n          steps: 3,\n          numCollectors: 1,\n          notifications: {\n            enabled: false,\n            addresses: \"\"\n          }\n        }\n      }\n    };\n    this.endpoint = {\"name\": \"\", checks: _.values(this.defaultChecks)};\n\n    var promises = [];\n    if (\"endpoint\" in $location.search()) {\n      promises.push(this.getEndpoint($location.search().endpoint));\n    } else {\n      this.endpoint = {name: \"\", checks: _.values(this.defaultChecks)};\n      this.pageReady = true;\n    }\n\n    promises.push(this.getCollectors());\n    Promise.all(promises).then(function() {\n      self.pageReady = true;\n  \n      $timeout(function() {\n        $anchorScroll();\n      }, 0, false);\n    });\n\n    if ($location.search().check) {\n      switch($location.search().check) {\n      case \"ping\":\n        self.showPing = true;\n        break;\n      case \"dns\":\n        self.showDNS = true;\n        break;\n      case \"http\":\n        self.showHTTP = true;\n        break;\n      case \"https\":\n        self.showHTTPS = true;\n        break;\n      }\n    }\n  }\n\n  getCollectors() {\n    var self = this;\n    return this.backendSrv.get('api/plugin-proxy/worldping-app/api/probes').then(function(collectors) {\n      self.collectors = collectors;\n      _.forEach(collectors, function(c) {\n        self.allCollectors.push(c.id);\n        _.forEach(c.tags, function(t) {\n          if (!(t in self.collectorsByTag)) {\n            self.collectorsByTag[t] = [];\n          }\n          self.collectorsByTag[t].push(c);\n        });\n      });\n      self.global_collectors = {collector_ids: self.allCollectors, collector_tags: []};\n    });\n  }\n\n  collectorCount(monitor) {\n    var self = this;\n    if (!monitor) {\n      return 0;\n    }\n    var ids = {};\n    _.forEach(monitor.collector_ids, function(id) {\n      ids[id] = true;\n    });\n    _.forEach(monitor.collector_tags, function(t) {\n      _.forEach(self.collectorsByTag[t], function(c) {\n        ids[c.id] = true;\n      });\n    });\n    return Object.keys(ids).length;\n  }\n\n  reset() {\n    var self = this;\n    this.discovered = false;\n    this.discoveryInProgress = false;\n    this.discoveryError = false;\n    this.showConfig = false;\n  }\n\n  cancel() {\n    this.reset();\n    this.ignoreChanges = true;\n    window.history.back();\n  }\n\n  getEndpoint(id) {\n    var self = this;\n    return this.backendSrv.get('api/plugin-proxy/worldping-app/api/endpoints/'+id).then(function(endpoint) {\n      self.endpoint = endpoint;\n      self.newEndpointName = endpoint.name;\n    });\n  }\n\n  remove(endpoint) {\n    var self = this;\n    this.backendSrv.delete('api/plugin-proxy/worldping-app/api/endpoints/' + endpoint.id).then(function() {\n      self.$location.path('plugins/worldping-app/page/endpoints');\n    });\n  }\n\n  updateEndpoint() {\n    this.endpoint.name = this.newEndpointName;\n    this.backendSrv.put('api/plugin-proxy/worldping-app/api/endpoints', this.endpoint);\n  }\n\n  save(location) {\n    var self = this;\n    var promises = [];\n\n    self.backendSrv.post('api/plugin-proxy/worldping-app/api/endpoints', self.endpoint).then(function() {\n      if (location) {\n        self.$location.path(location);\n      } else {\n        self.$location.path(\"plugins/worldping-app/page/endpoints\");\n      }\n    });\n  }\n\n  parseSuggestions(suggestions) {\n    var self = this;\n    _.forEach(suggestions, function(c) {\n      _.defaults(c, self.defaultChecks[c.type]);\n    });\n    this.endpoint.checks = suggestions;\n  }\n\n  skipDiscovery() {\n    this.discoveryInProgress = false;\n    this.showConfig = true;\n    this.discoveryError = false;\n  };\n\n  monitors(type) {\n    var check;\n    _.forEach(this.endpoint.checks, function(c) {\n      if (c.type === type) {\n        check = c;\n      }\n    });\n    return check;\n  }\n\n  orderChecks(check) {\n    var order = {\n      dns: 1,\n      ping: 2,\n      http: 3,\n      https: 4\n    };\n    return order[check.type];\n  }\n\n  discover(endpoint) {\n    var self = this;\n    this.discoveryInProgress = true;\n    this.discoveryError = false;\n    this.backendSrv.get('api/plugin-proxy/worldping-app/api/endpoints/discover', {name: endpoint.name}).then(function(resp) {\n      if (!self.showConfig) {\n        if (endpoint.name.indexOf(\"://\") > -1) {\n          //endpoint name is in the form scheme://domain\n          var parser = document.createElement('a');\n          parser.href = endpoint.name;\n          endpoint.name = parser.hostname;\n        }\n        self.showConfig = true;\n        self.discovered = true;\n        self.parseSuggestions(resp);\n      }\n    }, function() {\n      self.discoveryError = \"Failed to discover endpoint.\";\n    }).finally(function() {\n      self.discoveryInProgress = false;\n    });\n  }\n\n  addEndpoint() {\n    var self = this;\n    if (this.endpoint.id) {\n      return this.updateEndpoint();\n    }\n\n    this.backendSrv.post('api/plugin-proxy/worldping-app/api/endpoints', this.endpoint).then(function(resp) {\n      self.endpoint = resp;\n      self.ignoreChanges = true;\n      self.alertSrv.set(\"endpoint added\", '', 'success', 3000);\n      self.$location.path(\"plugins/worldping-app/page/endpoints\");\n    });\n  }\n\n  changesPending() {\n    var self = this;\n    var changes = false;\n    _.forEach(this.endpoint.checks, function(check) {\n      if (check._configured === false) {\n        return;\n      }\n      if (!angular.equals(check, self.lastCheckState[check.type])) {\n        changes = true;\n      }\n    });\n    return changes;\n  }\n\n  gotoDashboard(endpoint, type) {\n    var self = this;\n    if (!type) {\n      type = 'summary';\n    }\n    var search = {\n      \"var-collector\": \"All\",\n      \"var-endpoint\": this.endpoint.slug\n    };\n    switch(type) {\n      case \"summary\":\n        self.$location.path(\"/dashboard/db/worldping-endpoint-summary\").search(search);\n        break;\n      case \"ping\":\n        self.$location.path(\"/dashboard/db/worldping-endpoint-ping\").search(search);\n        break;\n      case \"dns\":\n        self.$location.path(\"/dashboard/db/worldping-endpoint-dns\").search(search);\n        break;\n      case \"http\":\n        search['var-protocol'] = \"http\";\n        self.$location.path(\"/dashboard/db/worldping-endpoint-web\").search(search);\n        break;\n      case \"https\":\n        search['var-protocol'] = \"https\";\n        self.$location.path(\"/dashboard/db/worldping-endpoint-web\").search(search);\n        break;\n      default:\n        self.$location.path(\"/dashboard/db/worldping-endpoint-summary\").search(search);\n        break;\n    }\n  }\n}\n\nEndpointConfigCtrl.templateUrl = 'public/plugins/worldping-app/components/endpoint/partials/endpoint_config.html';\n\nexport {EndpointConfigCtrl}"]}