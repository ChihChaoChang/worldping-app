{"version":3,"sources":["../../../src/components/probe/probe_details.js"],"names":[],"mappings":"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","file":"probe_details.js","sourcesContent":["import _ from 'lodash';\n\nexport class ProbeDetailsCtrl {\n\n  /** @ngInject */\n  constructor($scope, $injector, $location,$timeout, backendSrv, contextSrv) {\n    var self = this;\n    this.contextSrv = contextSrv;\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n    this.$timeout = $timeout;\n    this.pageReady = false;\n    this.collectors = [];\n    this.collector = null;\n    this.collectorUpdates = {};\n    var promise = this.getCollectors();\n    promise.then(function() {\n      self.getCollector($location.search().probe);\n    });\n    $scope.$on(\"$destroy\", function() {\n      $timeout.cancel(self.poller);\n    });\n  }\n\n  getCollectors() {\n    var self = this;\n    return this.backendSrv.get('api/plugin-proxy/raintank-worldping-app/api/collectors').then(function(collectors) {\n      self.collectors = collectors;\n    });\n  }\n\n  save() {\n    this.backendSrv.post(\"api/plugin-proxy/raintank-worldping-app/api/collectors\", this.collector);\n  }\n\n  getCollector(id) {\n    var self = this;\n    _.forEach(this.collectors, function(collector) {\n      if (collector.id === parseInt(id)) {\n        self.collector = collector;\n        self.collectorUpdates = {\n          \"name\": collector.name,\n          \"public\": collector.public\n        };\n        if (!collector.online) {\n          self.checkIfOnline();\n        }\n      }\n    });\n  }\n\n  setEnabled(newState) {\n    var self = this;\n    this.collector.enabled = newState;\n    this.backendSrv.post('api/plugin-proxy/raintank-worldping-app/api/collectors', this.collector).then(function() {\n      self.collector.enabled_change = new Date();\n    });\n  }\n\n  update() {\n    this.collector.name = this.collectorUpdates.name;\n    this.collector.public = this.collectorUpdates.public;\n    this.save();\n  }\n\n  gotoDashboard(collector) {\n    this.$location.path(\"/dashboard/db/worldping-probes\").search({\"var-probe\": collector.slug, \"var-endpoint\": \"All\"});\n  }\n\n  gotoEventDashboard(collector) {\n    this.$location.path(\"/dashboard/db/worldping-events\").search({\"var-probe\": collector.slug, \"var-endpoint\": \"All\"});\n  }\n\n  getEventsDashboardLink() {\n    if (!this.collector) {\n      return \"\";\n    }\n    var path = \"/dashboard-solo/db/worldping-events\";\n    var qstring = \"?panelId=1&fullscreen&from=now-1d&to=now&var-probe=\"+this.collector.slug;\n    return path + qstring;\n  }\n\n  checkIfOnline() {\n    var self = this;\n    this.verifyOnline = true;\n\n    this.backendSrv.get('api/plugin-proxy/raintank-worldping-app/api/collectors/'+this.collector.id).then(function(res) {\n      self.collector = res;\n      if (!res.online) {\n        self.poller = self.$timeout(function() {\n          self.checkIfOnline();\n        }, 1000);\n      }\n    });\n  }\n}\n\nProbeDetailsCtrl.templateUrl = 'public/plugins/raintank-worldping-app/components/probe/partials/probe_details.html';\n"]}