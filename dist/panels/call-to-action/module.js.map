{"version":3,"sources":["../../../src/panels/call-to-action/module.js"],"names":[],"mappings":"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","file":"module.js","sourcesContent":["import _ from 'lodash';\nimport {PanelCtrl} from 'app/plugins/sdk';\nimport {loadPluginCss} from 'app/plugins/sdk';\n\nloadPluginCss({\n  dark: 'plugins/worldping-app/css/worldping.dark.css',\n  light: 'plugins/worldping-app/css/worldping.light.css'\n});\n\nclass CallToActionCtrl extends PanelCtrl {\n  /** @ngInject */\n  constructor($scope, $injector, $location, backendSrv) {\n    super($scope, $injector);\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n\n    this.quotas = null;\n    this.endpointStatus = \"scopeEndpoints\";\n    this.userStatus = \"scopeUsers\";\n    this.collectorStatus = \"scopeCollectors\";\n  }\n\n  setEndpointStatus() {\n    if (! this.quotas) {\n      return;\n    }\n    if (this.quotas.endpoint.used === 0) {\n      this.endpointStatus = \"noEndpoints\";\n      return;\n    }\n    if (this.quotas.endpoint.used >= 1) {\n      this.endpointStatus = \"hasEndpoints\";\n      return;\n    }\n    //default.\n    this.endpointStatus = \"hasEndpoints\";\n    return;\n  }\n\n  setUserStatus() {\n    if (! this.quotas) {\n      return;\n    }\n    if (this.quotas.org_user.used <= 1) {\n      this.userStatus = \"noTeam\";\n      return;\n    }\n    if (this.quotas.org_user.used >= 2) {\n      this.userStatus = \"hasTeam\";\n      return;\n    }\n    //default.\n    this.userStatus = \"hasTeam\";\n    return;\n  }\n\n  setCollectorStatus() {\n    if (! this.quotas) {\n      return;\n    }\n    if (this.quotas.collector.used === 0) {\n      this.collectorStatus = \"noCollectors\";\n      return;\n    }\n    if (this.quotas.collector.used >= 1) {\n      this.collectorStatus = \"hasCollectors\";\n      return;\n    }\n    //default.\n    this.collectorStatus = \"hasCollectors\";\n    return;\n  }\n\n  allDone() {\n    if (! this.quotas) {\n      return false;\n    }\n    if (this.quotas.collector.used === 0) {\n      return false;\n    }\n    if (this.quotas.org_user.used <= 1) {\n      return false;\n    }\n    if (this.quotas.endpoint.used === 0) {\n      return false;\n    }\n    //default.\n    return true;\n  }\n\n  refresh() {\n    var self = this;\n    this.backendSrv.get('api/plugin-proxy/worldping-app/api/org/quotas').then(function(quotas) {\n      var quotaHash = {};\n      _.forEach(quotas, function(q) {\n        quotaHash[q.target] = q;\n      });\n      self.quotas = quotaHash;\n      self.setEndpointStatus();\n      self.setUserStatus();\n      self.setCollectorStatus();\n    });\n  }\n}\n\nCallToActionCtrl.templateUrl = 'public/plugins/worldping-app/panels/call-to-action/module.html'\n\nexport {CallToActionCtrl as PanelCtrl}\n"]}