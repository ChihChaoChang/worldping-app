{"version":3,"sources":["../../../src/panels/call-to-action/module.js"],"names":[],"mappings":"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","file":"module.js","sourcesContent":["import _ from 'lodash';\nimport {PanelCtrl} from 'app/plugins/sdk';\nimport {loadPluginCss} from 'app/plugins/sdk';\n\nloadPluginCss({\n  dark: 'plugins/raintank-worldping-app/css/worldping.dark.css',\n  light: 'plugins/raintank-worldping-app/css/worldping.light.css'\n});\n\nclass CallToActionCtrl extends PanelCtrl {\n\n  /** @ngInject */\n  constructor($scope, $injector, $location, backendSrv) {\n    super($scope, $injector);\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n\n    this.quotas = null;\n    this.endpointStatus = \"scopeEndpoints\";\n    this.userStatus = \"scopeUsers\";\n    this.collectorStatus = \"scopeCollectors\";\n  }\n\n  setEndpointStatus() {\n    if (! this.quotas) {\n      return;\n    }\n    if (this.quotas.endpoint.used === 0) {\n      this.endpointStatus = \"noEndpoints\";\n      return;\n    }\n    if (this.quotas.endpoint.used >= 1) {\n      this.endpointStatus = \"hasEndpoints\";\n      return;\n    }\n    //default.\n    this.endpointStatus = \"hasEndpoints\";\n    return;\n  }\n\n  setUserStatus() {\n    if (! this.quotas) {\n      return;\n    }\n    if (this.quotas.org_user.used <= 1) {\n      this.userStatus = \"noTeam\";\n      return;\n    }\n    if (this.quotas.org_user.used >= 2) {\n      this.userStatus = \"hasTeam\";\n      return;\n    }\n    //default.\n    this.userStatus = \"hasTeam\";\n    return;\n  }\n\n  setCollectorStatus() {\n    if (! this.quotas) {\n      return;\n    }\n    if (this.quotas.collector.used === 0) {\n      this.collectorStatus = \"noCollectors\";\n      return;\n    }\n    if (this.quotas.collector.used >= 1) {\n      this.collectorStatus = \"hasCollectors\";\n      return;\n    }\n    //default.\n    this.collectorStatus = \"hasCollectors\";\n    return;\n  }\n\n  allDone() {\n    if (! this.quotas) {\n      return false;\n    }\n    if (this.quotas.collector.used === 0) {\n      return false;\n    }\n    if (this.quotas.org_user.used <= 1) {\n      return false;\n    }\n    if (this.quotas.endpoint.used === 0) {\n      return false;\n    }\n    //default.\n    return true;\n  }\n\n  refresh() {\n    var self = this;\n    this.backendSrv.get('api/plugin-proxy/raintank-worldping-app/api/org/quotas').then(function(quotas) {\n      var quotaHash = {};\n      _.forEach(quotas, function(q) {\n        quotaHash[q.target] = q;\n      });\n      self.quotas = quotaHash;\n      self.setEndpointStatus();\n      self.setUserStatus();\n      self.setCollectorStatus();\n    });\n  }\n}\n\nCallToActionCtrl.templateUrl = 'public/plugins/raintank-worldping-app/panels/call-to-action/module.html';\n\nexport {\n  CallToActionCtrl as PanelCtrl\n};\n"]}